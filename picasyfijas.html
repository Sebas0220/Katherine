<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Picas y Fijas VS IA</title>
<style>
    :root{
        --c-acc:#00ffff;
        --c-bg1:#3a0066;
        --c-bg2:#120020;
    }
    *{box-sizing:border-box}
    body {
        margin: 0;
        font-family: 'Poppins',sans-serif;
        background: radial-gradient(circle at center, var(--c-bg1), var(--c-bg2) 80%);
        color:#fff;
        height:100vh;
        overflow:hidden;
        display:flex;
        flex-direction:column;
        align-items:center;
        justify-content:center;
        position:relative;
    }

    /* Canvas part√≠culas (sobre todo) */
    #particles {
        position: fixed;
        inset: 0;
        z-index: 30;
        pointer-events: none;
    }

    #turno {
        font-size:1.2rem;
        color: #bfefff;
        margin-bottom:6px;
        text-shadow:0 0 10px var(--c-acc);
        z-index:2;
    }

    h1{
        margin:0 0 12px 0;
        font-size:2.4rem;
        color:var(--c-acc);
        text-shadow:0 0 25px var(--c-acc);
        z-index:2;
    }

    .game-container {
        width:92%;
        max-width:1100px;
        display:flex;
        gap:20px;
        z-index:2;
        align-items:flex-start;
        justify-content:space-between;
        padding:28px;
        border-radius:18px;
        background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
        box-shadow:0 8px 40px rgba(0,0,0,0.6), 0 0 30px rgba(0,255,255,0.06);
    }

    .panel{
        width:48%;
        border-radius:12px;
        padding:18px;
        background:linear-gradient(180deg, rgba(0,0,0,0.18), rgba(255,255,255,0.02));
        box-shadow: inset 0 1px 0 rgba(255,255,255,0.02);
        transition:box-shadow .35s, transform .35s;
        position:relative;
        overflow:hidden;
    }

    .panel h2{
        color:var(--c-acc);
        margin:0 0 8px 0;
        text-shadow:0 0 8px rgba(0,255,255,0.2);
        display:flex;
        justify-content:center;
        gap:10px;
        align-items:center;
    }

    .panel.glow-player{ box-shadow:0 0 30px #00ffcc, 0 0 80px rgba(0,255,204,0.06); transform:translateY(-4px);}
    .panel.glow-ia{ box-shadow:0 0 30px #ff66ff, 0 0 80px rgba(255,102,255,0.06); transform:translateY(-4px); }

    input[type="text"]{
        width:78%;
        padding:10px 12px;
        font-size:1rem;
        border-radius:10px;
        border:none;
        outline:none;
        text-align:center;
        background:rgba(255,255,255,0.06);
        color:#fff;
    }
    button{
        padding:10px 16px;
        border-radius:10px;
        border:none;
        cursor:pointer;
        font-weight:700;
        background:linear-gradient(135deg,#00ffff,#0088ff);
        color:#000;
    }
    button:hover{ transform:scale(1.04) }

    .log{
        margin-top:12px;
        height:200px;
        overflow:auto;
        background:rgba(0,0,0,0.28);
        border-radius:10px;
        padding:10px;
        font-size:0.95rem;
        text-align:left;
    }

    .status-bubble{
        display:inline-block;
        margin-top:10px;
        padding:8px 14px;
        border-radius:999px;
        background:rgba(255,255,255,0.06);
        box-shadow:0 4px 18px rgba(0,0,0,0.4);
        font-weight:600;
        color:#e8ffff;
        opacity:0.98;
    }

    /* Pensando dots */
    .dots {
        display:inline-block;
        margin-left:8px;
        vertical-align:middle;
        width:36px;
        text-align:left;
    }
    .dot{
        display:inline-block;
        width:6px; height:6px;
        margin:0 3px;
        background:#fff;
        border-radius:50%;
        opacity:0.2;
        transform:translateY(0);
        animation: dotPulse 1.2s infinite ease-in-out;
    }
    .dot:nth-child(2){ animation-delay:0.15s }
    .dot:nth-child(3){ animation-delay:0.3s }
    @keyframes dotPulse{
        0%{ opacity:0.2; transform:translateY(0)}
        50%{ opacity:1; transform:translateY(-6px)}
        100%{ opacity:0.2; transform:translateY(0)}
    }

    .winnerMsg{
        margin-top:14px;
        font-size:1.05rem;
        text-align:center;
        color:#bfffdc;
        text-shadow:0 0 10px rgba(0,255,204,0.25);
    }

    #reiniciar{
        margin-top:18px;
        padding:12px 20px;
        border-radius:12px;
        background:linear-gradient(135deg,#ff66ff,#00ffff);
        border:none;
        font-weight:800;
        display:none;
        z-index:2;
    }

    /* lluvia matem√°tica muy opaca (a ras de body) */
    .bgSymbol{
        position: absolute;
        top:-12%;
        color: rgba(255,255,255,0.12);
        filter: blur(1px);
        animation: fallSlow linear infinite;
        z-index:1;
        font-weight:700;
    }
    @keyframes fallSlow{
        0%{ transform: translateY(0) rotate(0deg); opacity:1 }
        100%{ transform: translateY(120vh) rotate(360deg); opacity:0 }
    }

    /* responsive */
    @media (max-width:820px){
        .game-container{ flex-direction:column; gap:16px; padding:18px}
        .panel{ width:100% }
        h1{font-size:1.8rem}
    }
</style>
</head>
<body>
    <!-- canvas para part√≠culas de victoria -->
    <canvas id="particles"></canvas>

    <div id="turno">Esperando jugador...</div>
    <h1>üéØ Picas y Fijas VS IA ü§ñ</h1>

    <div class="game-container" role="main" aria-live="polite">
        <div class="panel" id="panelJugador">
            <h2>üë§ Jugador</h2>
            <div id="jugadorArea">
                <p>Ingresa tu n√∫mero secreto (4 d√≠gitos √∫nicos):</p>
                <input id="numeroJugador" maxlength="4" placeholder="Ej: 1234" inputmode="numeric" />
                <div style="height:10px"></div>
                <button id="confirmar">Confirmar</button>
            </div>

            <div class="status-bubble" id="estadoJugador" style="display:none"></div>
            <div id="logJugador" class="log" aria-live="polite"></div>
        </div>

        <div class="panel" id="panelIA">
            <h2>ü§ñ IA</h2>
            <div class="status-bubble" id="estadoIA" style="display:none"></div>
            <div id="logIA" class="log" aria-live="polite"></div>
        </div>
    </div>

    <button id="reiniciar">üîÅ Reiniciar Juego</button>

<script>
/* ---------- L√ìGICA DEL JUEGO ---------- */
const numeroJugadorInput = document.getElementById('numeroJugador');
const confirmarBtn = document.getElementById('confirmar');
const logJugador = document.getElementById('logJugador');
const logIA = document.getElementById('logIA');
const estadoJugador = document.getElementById('estadoJugador');
const estadoIA = document.getElementById('estadoIA');
const turnoTexto = document.getElementById('turno');
const reiniciarBtn = document.getElementById('reiniciar');
const panelJugador = document.getElementById('panelJugador');
const panelIA = document.getElementById('panelIA');

let numeroJugador = '';
let numeroIA = '';
let terminado = false;

function generarNumeroAleatorio() {
    let num;
    do {
        num = String(Math.floor(Math.random()*10000)).padStart(4,'0');
    } while (new Set(num).size < 4);
    return num;
}

function calcularPicasFijas(secreto, intento){
    let p=0,f=0;
    for(let i=0;i<4;i++){
        if(intento[i]===secreto[i]) f++;
        else if(secreto.includes(intento[i])) p++;
    }
    return {picas:p, fijas:f};
}

function mostrarBurbuja(elt, texto, showDots=false, color=''){
    if(showDots){
        elt.innerHTML = `${texto}<span class="dots"><span class="dot"></span><span class="dot"></span><span class="dot"></span></span>`;
    } else {
        elt.textContent = texto;
    }
    elt.style.display = 'inline-block';
    if(color) elt.style.boxShadow = `0 0 14px ${color}`;
    setTimeout(()=>{ elt.style.boxShadow=''; }, 1400);
}

function hideBurbuja(elt){
    elt.style.display = 'none';
}

function turnoJugador(intento){
    if(terminado) return;
    const res = calcularPicasFijas(numeroIA, intento);
    const idx = logJugador.children.length+1;
    const line = document.createElement('div');
    line.innerHTML = `Intento ${idx}: <b>${intento}</b> ‚Üí üéØ ${res.fijas} Fijas, ‚ö° ${res.picas} Picas`;
    logJugador.appendChild(line);
    logJugador.scrollTop = logJugador.scrollHeight;

    panelJugador.classList.add('glow-player');
    mostrarBurbuja(estadoJugador, `Resultado: ${res.fijas} Fijas, ${res.picas} Picas`, false, res.fijas>0?'#00ffcc':'#ffff66');
    setTimeout(()=>panelJugador.classList.remove('glow-player'),700);

    if(res.fijas===4){
        terminarJuego('Jugador');
    } else {
        turnoTexto.textContent = 'ü§ñ Turno de la IA...';
        mostrarBurbuja(estadoIA, 'Pensando...', true, '#ff88ff');
        setTimeout(()=>{ hideBurbuja(estadoIA); turnoIA(); }, 1200);
    }
}

function turnoIA(){
    if(terminado) return;
    const intento = generarNumeroAleatorio();
    const res = calcularPicasFijas(numeroJugador, intento);
    const idx = logIA.children.length+1;
    const line = document.createElement('div');
    line.innerHTML = `Intento ${idx}: <b>${intento}</b> ‚Üí üéØ ${res.fijas} Fijas, ‚ö° ${res.picas} Picas`;
    logIA.appendChild(line);
    logIA.scrollTop = logIA.scrollHeight;

    panelIA.classList.add('glow-ia');
    mostrarBurbuja(estadoIA, `Resultado: ${res.fijas} Fijas, ${res.picas} Picas`, false, res.fijas>0?'#00ffcc':'#ff99ff');
    setTimeout(()=>panelIA.classList.remove('glow-ia'),700);

    if(res.fijas===4){
        terminarJuego('IA', intento);
    } else {
        turnoTexto.textContent = 'üü¢ Tu turno';
    }
}

function terminarJuego(ganador, numeroFinal){
    terminado = true;
    if(ganador==='Jugador'){
        turnoTexto.innerHTML = `<span style="color:#bfffdc;font-weight:800">üéâ ¬°Has ganado!</span> ‚Äî Tu n√∫mero: <b>${numeroJugador}</b>`;
        const rect = panelJugador.getBoundingClientRect();
        showVictoryParticles(rect.left + rect.width/2, rect.top + rect.height/2, 'player');
        playVictorySound('player');
    } else {
        turnoTexto.innerHTML = `<span style="color:#ffccff;font-weight:800">ü§ñ La IA ha ganado</span> ‚Äî Su n√∫mero: <b>${numeroIA}</b>`;
        const rect = panelIA.getBoundingClientRect();
        showVictoryParticles(rect.left + rect.width/2, rect.top + rect.height/2, 'ia');
        playVictorySound('ia');
    }
    reiniciarBtn.style.display='inline-block';
    const reveal = document.createElement('div');
    reveal.className='winnerMsg';
    if(ganador==='Jugador'){
        reveal.innerHTML = `N√∫mero IA: <b>${numeroIA}</b>`;
        logJugador.appendChild(reveal);
    } else {
        reveal.innerHTML = `Tu n√∫mero: <b>${numeroJugador}</b>`;
        logIA.appendChild(reveal);
    }
}

/* eventos UI */
confirmarBtn.addEventListener('click', ()=>{
    const v = numeroJugadorInput.value.trim();
    if(!/^\d{4}$/.test(v) || new Set(v).size<4){
        alert('Ingresa 4 d√≠gitos √∫nicos (ej. 1234).');
        return;
    }
    numeroJugador = v;
    numeroIA = generarNumeroAleatorio();
    const area = document.getElementById('jugadorArea');
    area.innerHTML = `<p>Intenta adivinar el n√∫mero de la IA:</p>
        <input id="intento" maxlength="4" placeholder="Ej: 5678" />
        <div style="height:8px"></div>
        <button id="probar">Probar</button>`;
    document.getElementById('probar').addEventListener('click', ()=>{
        if(terminado) return;
        const intento = document.getElementById('intento').value.trim();
        if(!/^\d{4}$/.test(intento) || new Set(intento).size<4){
            alert('Ingresa 4 d√≠gitos √∫nicos.');
            return;
        }
        turnoTexto.textContent = 'üü¢ Jugaste';
        turnoJugador(intento);
    });
    turnoTexto.textContent = 'üü¢ Tu turno';
    mostrarBurbuja(estadoJugador, 'Listo para jugar', false, '#aaffff');
});

reiniciarBtn.addEventListener('click', ()=> location.reload());


const canvas = document.getElementById('particles');
const ctx = canvas.getContext('2d');
let W = canvas.width = innerWidth;
let H = canvas.height = innerHeight;
window.addEventListener('resize', ()=>{ W = canvas.width = innerWidth; H = canvas.height = innerHeight; });

let particles = [];
function Particle(x,y, color){
    this.x = x;
    this.y = y;
    this.vx = (Math.random()-0.5)*6;
    this.vy = (Math.random()-1.5)*6;
    this.size = Math.random()*6 + 4;
    this.life = 80 + Math.random()*40;
    this.color = color;
}
Particle.prototype.update = function(){ this.x += this.vx; this.y += this.vy; this.vy += 0.12; this.life--; };
Particle.prototype.draw = function(){
    ctx.beginPath();
    ctx.fillStyle = this.color;
    ctx.globalAlpha = Math.max(0, this.life/120);
    ctx.arc(this.x, this.y, this.size, 0, Math.PI*2);
    ctx.fill();
    ctx.globalAlpha = 1;
};

function spawnParticles(x,y,type){
    const cols = type==='player' ? ['#00ffcc','#aaffff','#00ffaa'] : ['#ff66ff','#ff99ff','#ff33aa'];
    for(let i=0;i<40;i++){
        particles.push(new Particle(x + (Math.random()-0.5)*80, y + (Math.random()-0.5)*40, cols[Math.floor(Math.random()*cols.length)]));
    }
}

function animateParticles(){
    ctx.clearRect(0,0,W,H);
    for(let i=particles.length-1;i>=0;i--){
        const p = particles[i];
        p.update();
        p.draw();
        if(p.life<=0 || p.y>H+50) particles.splice(i,1);
    }
    requestAnimationFrame(animateParticles);
}
animateParticles();

function showVictoryParticles(xScreen, yScreen, type){
    spawnParticles(xScreen, yScreen, type);
}

const AudioCtx = window.AudioContext || window.webkitAudioContext;
const audioCtx = AudioCtx ? new AudioCtx() : null;

function playTone(freq, time, type='sine', gain=0.06){
    if(!audioCtx) return;
    const o = audioCtx.createOscillator();
    const g = audioCtx.createGain();
    o.type = type;
    o.frequency.value = freq;
    g.gain.value = gain;
    o.connect(g); g.connect(audioCtx.destination);
    o.start();
    g.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + time);
    o.stop(audioCtx.currentTime + time + 0.02);
}

function playVictorySound(winner){
    if(!audioCtx) return;
    if(winner==='player'){
        playTone(880,0.18,'sine',0.08);
        setTimeout(()=>playTone(1100,0.14,'sine',0.06),160);
        setTimeout(()=>playTone(1320,0.22,'sine',0.06),320);
    } else {
        playTone(220,0.18,'sawtooth',0.08);
        setTimeout(()=>playTone(176,0.14,'sawtooth',0.06),160);
        setTimeout(()=>playTone(132,0.22,'sawtooth',0.06),320);
    }
}

const symbols = ["‚àö","œÄ","‚àë","‚à´","‚àû","‚àÜ","¬µ","Œ∏","Œª","Œ©","œà","‚â†","‚âà"];
function spawnBgSymbol(){
    const s = document.createElement('div');
    s.className='bgSymbol';
    s.textContent = symbols[Math.floor(Math.random()*symbols.length)];
    s.style.left = (Math.random()*100) + 'vw';
    s.style.fontSize = (Math.random()*2+0.8) + 'rem';
    s.style.animationDuration = (Math.random()*7 + 8) + 's';
    s.style.opacity = 0.12 + Math.random()*0.12;
    document.body.appendChild(s);
    setTimeout(()=> s.remove(), 11000);
}
setInterval(spawnBgSymbol, 420);

window.addEventListener('click', ()=>{ if(audioCtx && audioCtx.state==='suspended') audioCtx.resume(); }, {once:true});
</script>
</body>
</html>
